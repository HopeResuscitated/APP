<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Narcan Partner ‚Äî Hope Resuscitated</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

<!-- Link to PWA manifest for Google Play packaging -->
<link rel="manifest" href="manifest.json">
<style>
:root {
  --bg: #0d0d14;
  --bg2: #11111c;
  --card: #17172a;
  --card2: #1e1e38;
  --border: #252540;
  --border2: #333360;
  --text: #ffffff;
  --text2: #9090b8;
  --text3: #505070;
  --purple: #a78bfa;
  --purple-soft: #1e1040;
  --purple-border: #3d2880;
  --green: #10b981;
  --green-glow: rgba(16,185,129,0.35);
  --green-soft: #091f14;
  --red: #ef4444;
  --red-glow: rgba(239,68,68,0.4);
  --amber: #f59e0b;
  --radius: 16px;
  --radius-sm: 12px;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;background:#08080f;font-family:'Inter',sans-serif;color:var(--text);}
body{display:flex;align-items:center;justify-content:center;}

#phone{
  width:390px;max-width:100vw;height:100vh;max-height:844px;
  background:var(--bg);display:flex;flex-direction:column;
  position:relative;overflow:hidden;
  box-shadow:0 0 100px rgba(139,92,246,0.12),0 0 0 1px rgba(255,255,255,0.04);
  border-radius:40px;
}
@media(max-width:420px){#phone{border-radius:0;height:100dvh;max-height:none;}}

/* STATUS */
#statusbar{
  height:46px;background:var(--bg);border-bottom:1px solid rgba(255,255,255,0.04);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 22px;flex-shrink:0;z-index:50;
}
.s-time{font-size:15px;font-weight:700;}
.s-icons{font-size:12px;color:var(--text3);}

/* SCREENS */
.screen{display:none;flex:1;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;}
.screen.active{display:flex;flex-direction:column;}

/* BOTTOM NAV */
#bottom-nav{
  height:70px;background:var(--bg2);border-top:1px solid var(--border);
  display:grid;grid-template-columns:repeat(4,1fr);
  flex-shrink:0;z-index:50;padding-bottom:6px;
}
.nb{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:4px;cursor:pointer;border:none;background:none;padding:6px 4px 0;
  transition:all 0.15s;
}
.nb:active{opacity:0.5;}
.nb-icon{font-size:22px;line-height:1;}
.nb-lbl{font-size:10px;font-weight:700;letter-spacing:0.5px;color:var(--text3);text-transform:uppercase;transition:color 0.15s;}
.nb.active .nb-lbl{color:var(--green);}
.nb.active .nb-icon{filter:none;}
.nb.red-active .nb-lbl{color:var(--red);}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SHARED COMPONENTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.card{background:var(--card);border-radius:var(--radius);border:1px solid var(--border);overflow:hidden;}
.pill-badge{
  display:inline-flex;align-items:center;gap:6px;
  padding:7px 14px;border-radius:50px;
  font-size:13px;font-weight:600;
  background:var(--purple-soft);color:var(--purple);border:1px solid var(--purple-border);
}

.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  font-family:'Inter';font-size:15px;font-weight:700;
  padding:14px 22px;border-radius:var(--radius-sm);border:none;cursor:pointer;
  transition:all 0.15s;
}
.btn:active{transform:scale(0.97);}
.btn-full{width:100%;}
.btn-red{background:linear-gradient(135deg,#ef4444,#dc2626);color:white;box-shadow:0 4px 16px var(--red-glow);}
.btn-green{background:var(--green);color:white;box-shadow:0 4px 14px var(--green-glow);}
.btn-dark{background:var(--card2);color:var(--text2);border:1px solid var(--border2);}

.info-box{border-radius:var(--radius-sm);padding:14px 16px;font-size:14px;line-height:1.65;color:var(--text2);}
.info-box strong{display:block;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:5px;}
.info-box.purple{background:var(--purple-soft);border:1px solid var(--purple-border);}
.info-box.purple strong{color:var(--purple);}
.info-box.green{background:var(--green-soft);border:1px solid rgba(16,185,129,0.25);}
.info-box.green strong{color:var(--green);}
.info-box.amber{background:#1a1004;border:1px solid rgba(245,158,11,0.25);}
.info-box.amber strong{color:var(--amber);}
.info-box.red{background:#1a0808;border:1px solid rgba(239,68,68,0.25);}
.info-box.red strong{color:var(--red);}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HOME ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.hope-header{
  background:#0a0a14;padding:14px 18px;
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;gap:12px;flex-shrink:0;
}
.hope-logo{
  width:50px;height:50px;border-radius:10px;
  background:linear-gradient(135deg,#1a0a30,#2a1458);
  border:1px solid var(--purple-border);
  display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;
}
.hope-name{font-size:18px;font-weight:900;color:var(--purple);letter-spacing:-0.3px;}
.hope-sub{font-size:10px;font-weight:700;letter-spacing:1.8px;text-transform:uppercase;color:rgba(167,139,250,0.55);margin-top:2px;}

.tagline-strip{
  background:#09091a;border-bottom:1px solid var(--border);
  padding:10px 20px;text-align:center;flex-shrink:0;
}
.tagline-main{font-size:12px;font-weight:800;letter-spacing:1.5px;color:var(--purple);}
.tagline-sub{font-size:10px;font-weight:600;letter-spacing:1.2px;color:var(--text3);margin-top:3px;}

.hero-section{padding:28px 20px 20px;text-align:center;}
.hero-title{font-size:36px;font-weight:900;line-height:1.1;letter-spacing:-1px;margin-bottom:12px;}
.hero-desc{font-size:16px;color:var(--text2);line-height:1.65;margin-bottom:26px;}

.start-em-btn{
  width:100%;background:linear-gradient(135deg,#ef4444,#c82020);
  border:none;border-radius:var(--radius);padding:22px 24px;
  display:flex;align-items:center;gap:16px;cursor:pointer;
  box-shadow:0 8px 36px rgba(239,68,68,0.45);transition:all 0.15s;
}
.start-em-btn:active{transform:scale(0.98);}
.sem-icon{
  width:48px;height:48px;background:rgba(255,255,255,0.18);
  border-radius:12px;display:flex;align-items:center;justify-content:center;
  font-size:24px;flex-shrink:0;
}
.sem-title{font-size:19px;font-weight:900;color:white;letter-spacing:-0.3px;text-align:left;}

.learn-section{padding:4px 18px 18px;}
.learn-head{font-size:20px;font-weight:900;margin-bottom:14px;}
.lcard{
  background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
  padding:20px;display:flex;align-items:center;gap:14px;
  cursor:pointer;transition:background 0.15s;margin-bottom:10px;
}
.lcard:active{background:var(--card2);}
.lcard-icon{
  width:54px;height:54px;background:var(--purple-soft);border:1px solid var(--purple-border);
  border-radius:12px;display:flex;align-items:center;justify-content:center;
  font-size:26px;flex-shrink:0;
}
.lcard-title{font-size:17px;font-weight:800;margin-bottom:4px;}
.lcard-desc{font-size:13px;color:var(--text2);line-height:1.5;}

.disclaimer{
  background:rgba(255,255,255,0.03);border:1px solid var(--border);
  border-radius:var(--radius-sm);padding:14px 16px;
  display:flex;gap:12px;align-items:flex-start;margin:0 18px 14px;
}
.d-icon{width:28px;height:28px;background:var(--border2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;margin-top:1px;}
.d-text{font-size:13px;color:var(--text2);line-height:1.6;}

.contact-section{
  background:linear-gradient(135deg,#1a1040,#22185a);
  border:1px solid var(--purple-border);border-radius:var(--radius);
  padding:20px;margin:0 18px 22px;
}
.contact-head{font-size:15px;font-weight:800;color:var(--purple);margin-bottom:14px;}
.crow{display:flex;align-items:center;gap:10px;font-size:14px;color:var(--text2);margin-bottom:9px;}
.crow:last-child{margin-bottom:0;}
.crow a{color:var(--purple);}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GUIDE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.guide-top{padding:18px 18px 14px;border-bottom:1px solid var(--border);flex-shrink:0;}
.guide-back{display:flex;align-items:center;gap:5px;font-size:14px;color:var(--text2);cursor:pointer;margin-bottom:14px;}
.breadcrumb{display:flex;gap:8px;overflow-x:auto;scrollbar-width:none;margin-bottom:0;}
.breadcrumb::-webkit-scrollbar{display:none;}
.bc-item{
  padding:6px 14px;border-radius:50px;font-size:13px;font-weight:600;
  white-space:nowrap;flex-shrink:0;cursor:pointer;transition:all 0.15s;
  background:var(--card2);border:1px solid var(--border);color:var(--text3);
}
.bc-item.active{background:var(--purple-soft);border-color:var(--purple-border);color:var(--purple);}

.guide-body{overflow-y:auto;-webkit-overflow-scrolling:touch;flex:1;padding-bottom:16px;}
.guide-section{padding:20px 18px 0;}
.g-section-title{font-size:22px;font-weight:900;margin-bottom:14px;}
.sign-card{
  background:var(--card);border:1px solid var(--border);border-radius:var(--radius-sm);
  padding:16px 18px;display:flex;align-items:center;gap:14px;margin-bottom:10px;
}
.sign-ico{
  width:46px;height:46px;border-radius:10px;
  background:rgba(251,146,60,0.12);
  display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;
}
.sign-title{font-size:15px;font-weight:700;}
.sign-desc{font-size:13px;color:var(--text2);margin-top:2px;}

.step-ref{
  background:var(--card);border:1px solid var(--border);border-radius:var(--radius-sm);
  padding:16px 18px;display:flex;align-items:center;gap:14px;
  margin-bottom:10px;cursor:pointer;transition:background 0.15s;
}
.step-ref:active{background:var(--card2);}
.step-badge{
  width:36px;height:36px;border-radius:10px;background:var(--purple);
  display:flex;align-items:center;justify-content:center;
  font-size:15px;font-weight:900;color:white;flex-shrink:0;
}
.step-ref-title{font-size:15px;font-weight:700;}
.step-ref-sub{font-size:13px;color:var(--text2);margin-top:2px;}
.step-ref-arrow{margin-left:auto;color:var(--text3);font-size:18px;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TIMER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.timer-top{padding:20px 18px 14px;border-bottom:1px solid var(--border);flex-shrink:0;}
.timer-body{overflow-y:auto;-webkit-overflow-scrolling:touch;flex:1;padding:16px 18px 24px;display:flex;flex-direction:column;gap:14px;}
.timer-card-inner{padding:28px 20px 24px;text-align:center;}
.big-timer{
  font-size:82px;font-weight:900;letter-spacing:-4px;line-height:1;
  color:var(--green);transition:color 0.3s;
}
.big-timer.urgent{color:var(--red);}
.timer-lbl{font-size:11px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-top:8px;}
.t-btns{display:flex;gap:10px;margin-top:20px;}
.t-btn{
  flex:1;padding:14px 10px;border-radius:12px;border:none;cursor:pointer;
  font-family:'Inter';font-size:15px;font-weight:700;transition:all 0.15s;
}
.t-btn:active{transform:scale(0.97);}
.t-green{background:var(--green);color:white;box-shadow:0 4px 14px var(--green-glow);}
.t-dark{background:var(--card2);color:var(--text2);border:1px solid var(--border2);}
.t-icon{flex:0 0 50px;font-size:18px;}

.dose-slots{display:flex;gap:10px;padding:16px 16px 0;}
.ds{
  flex:1;background:var(--bg);border:2px solid var(--border);border-radius:12px;
  padding:14px 8px;text-align:center;transition:all 0.3s;
}
.ds.given{border-color:var(--green);background:var(--green-soft);}
.ds-n{font-size:28px;font-weight:900;color:var(--text3);display:block;transition:color 0.3s;}
.ds.given .ds-n{color:var(--green);}
.ds-l{font-size:10px;color:var(--text3);font-weight:700;letter-spacing:1px;text-transform:uppercase;}
.ds-t{font-size:11px;color:var(--green);font-weight:600;margin-top:4px;display:none;}
.ds.given .ds-t{display:block;}

.breath-wrap{padding:24px 20px;text-align:center;}
.breath-ring{
  width:112px;height:112px;border-radius:50%;
  border:3px solid var(--green);background:var(--green-soft);
  margin:0 auto 16px;display:flex;align-items:center;justify-content:center;
  font-size:42px;cursor:pointer;transition:all 0.3s;user-select:none;
}
.breath-ring.active{animation:breathe 5s ease-in-out infinite;}
@keyframes breathe{
  0%,100%{transform:scale(1);box-shadow:0 0 0 0 rgba(16,185,129,0.4);}
  50%{transform:scale(1.2);box-shadow:0 0 0 22px rgba(16,185,129,0);}
}
.b-lbl{font-size:15px;font-weight:700;color:var(--green);}
.b-sub{font-size:13px;color:var(--text2);margin-top:5px;line-height:1.5;}

.warn-strip{
  background:#1a0808;border:1px solid rgba(239,68,68,0.25);border-radius:12px;
  padding:14px 16px;display:flex;gap:10px;align-items:flex-start;
  font-size:13px;color:#fca5a5;line-height:1.5;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HELP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.help-top{padding:20px 18px 14px;border-bottom:1px solid var(--border);flex-shrink:0;}
.help-body{overflow-y:auto;-webkit-overflow-scrolling:touch;flex:1;padding:16px 18px 24px;display:flex;flex-direction:column;gap:14px;}
.section-lbl{font-size:11px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--text3);}
.res-item{
  display:flex;align-items:center;gap:14px;padding:16px 18px;
  border-bottom:1px solid rgba(255,255,255,0.04);
  cursor:pointer;transition:background 0.1s;
}
.res-item:last-child{border-bottom:none;}
.res-item:active{background:var(--card2);}
.res-ico{width:46px;height:46px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;}
.res-title{font-size:15px;font-weight:700;}
.res-sub{font-size:12px;color:var(--text2);margin-top:2px;}
.res-arrow{margin-left:auto;color:var(--text3);font-size:18px;}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EMERGENCY FLOW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#em-overlay,#pr-overlay{
  display:none;position:absolute;inset:0;
  background:#07070f;z-index:200;flex-direction:column;overflow:hidden;
}
#em-overlay.on,#pr-overlay.on{display:flex;}

.flow-top{
  padding:13px 18px 11px;display:flex;align-items:center;justify-content:space-between;
  flex-shrink:0;background:#09091a;border-bottom:1px solid rgba(255,255,255,0.05);
}
.flow-exit{font-size:15px;font-weight:600;color:var(--text2);cursor:pointer;padding:6px 0;}
.flow-911{
  display:flex;align-items:center;gap:7px;
  background:var(--red);color:white;padding:9px 18px;border-radius:50px;
  font-size:14px;font-weight:800;cursor:pointer;border:none;
  box-shadow:0 4px 14px var(--red-glow);text-decoration:none;
}
.flow-pr-badge{font-size:12px;font-weight:800;color:var(--purple);letter-spacing:1px;}

.flow-prog{padding:10px 18px 12px;background:#09091a;border-bottom:1px solid rgba(255,255,255,0.04);flex-shrink:0;}
.flow-step-label{font-size:13px;color:var(--text3);font-weight:600;text-align:center;margin-bottom:7px;}
.prog-bar{height:3px;background:rgba(255,255,255,0.07);border-radius:3px;overflow:hidden;}
.prog-fill{height:100%;border-radius:3px;transition:width 0.4s ease;}
.prog-fill.em-fill{background:var(--green);}
.prog-fill.pr-fill{background:var(--purple);}

.flow-content{flex:1;overflow-y:auto;padding:26px 22px 16px;}
.flow-title{font-size:30px;font-weight:900;letter-spacing:-0.5px;line-height:1.15;text-align:center;margin-bottom:16px;}
.flow-desc{font-size:16px;color:var(--text2);text-align:center;line-height:1.7;margin-bottom:22px;}

.photo-placeholder{
  width:100%;aspect-ratio:4/3;border-radius:var(--radius);overflow:hidden;
  background:linear-gradient(135deg,#131325,#0e0e20);
  border:1px solid var(--border);margin-bottom:20px;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;
}
.ph-big{font-size:60px;}
.ph-caption{font-size:14px;color:var(--text3);font-weight:600;text-align:center;padding:0 20px;}

.nc-pick{
  background:var(--card);border:2px solid var(--border2);border-radius:var(--radius);
  padding:18px 20px;display:flex;align-items:center;gap:16px;
  cursor:pointer;transition:all 0.2s;margin-bottom:12px;
}
.nc-pick.sel{border-color:var(--green);background:var(--green-soft);}
.nc-ico{width:54px;height:54px;border-radius:12px;background:rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:center;font-size:28px;flex-shrink:0;}
.nc-title{font-size:17px;font-weight:800;}
.nc-sub{font-size:13px;color:var(--text2);margin-top:3px;}

.obs-box{
  background:var(--bg2);border:2px solid var(--green);border-radius:var(--radius);
  padding:22px 20px;text-align:center;margin-bottom:16px;
}
.obs-head{font-size:13px;font-weight:800;color:var(--green);letter-spacing:0.5px;margin-bottom:10px;}
.obs-num{font-size:66px;font-weight:900;letter-spacing:-3px;line-height:1;color:white;transition:color 0.3s;}
.obs-num.urgent{color:var(--red);}
.obs-sub{font-size:12px;color:var(--text3);font-weight:600;margin-top:6px;}
.obs-btns{display:flex;gap:10px;justify-content:center;margin-top:14px;}
.obs-btn{
  width:46px;height:46px;border-radius:50%;background:rgba(255,255,255,0.07);
  border:none;cursor:pointer;font-size:18px;color:white;transition:all 0.15s;
}
.obs-btn:active{transform:scale(0.9);}

.check-list{display:flex;flex-direction:column;gap:10px;}
.check-item{
  display:flex;align-items:center;gap:12px;
  background:var(--card2);border:1px solid var(--border);border-radius:10px;
  padding:13px 16px;font-size:14px;color:var(--text2);font-weight:500;
}
.ci-ico{font-size:20px;flex-shrink:0;}

.flow-footer{
  padding:13px 18px 14px;background:#09091a;
  border-top:1px solid rgba(255,255,255,0.05);
  display:flex;gap:12px;flex-shrink:0;
}
.f-back{
  flex:1;padding:16px;border-radius:14px;
  background:var(--card2);border:1px solid var(--border2);
  color:var(--text2);font-family:'Inter';font-size:16px;font-weight:700;
  cursor:pointer;transition:all 0.15s;display:flex;align-items:center;justify-content:center;gap:5px;
}
.f-back:disabled{opacity:0.22;cursor:not-allowed;}
.f-next{
  flex:2;padding:16px;border-radius:14px;border:none;
  color:white;font-family:'Inter';font-size:16px;font-weight:900;
  cursor:pointer;transition:all 0.15s;display:flex;align-items:center;justify-content:center;gap:6px;
}
.f-next:active{transform:scale(0.98);}
.f-next.em-next{background:var(--green);box-shadow:0 4px 20px var(--green-glow);}
.f-next.pr-next{background:var(--purple);box-shadow:0 4px 20px rgba(167,139,250,0.35);}
</style>
</head>
<body>
<div id="phone">

  <!-- STATUS BAR -->
  <div id="statusbar">
    <div class="s-time" id="clock">10:05</div>
    <div class="s-icons">5G ‚ñÆ‚ñÆ‚ñÆ üîã</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê EMERGENCY OVERLAY ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="em-overlay">
    <div class="flow-top">
      <span class="flow-exit" onclick="closeFlow('em')">‚Äπ Exit</span>
      <a class="flow-911" href="tel:911" onclick="return confirm('Call 911 now?')">üìû Call 911</a>
    </div>
    <div class="flow-prog">
      <div class="flow-step-label" id="em-label">Step 1 of 10</div>
      <div class="prog-bar"><div class="prog-fill em-fill" id="em-fill" style="width:10%"></div></div>
    </div>
    <div class="flow-content" id="em-content"></div>
    <div class="flow-footer">
      <button class="f-back" id="em-back" onclick="emNav(-1)">‚Äπ Back</button>
      <button class="f-next em-next" id="em-next" onclick="emNav(1)">Next Step ‚Ä∫</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê PRACTICE OVERLAY ‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="pr-overlay">
    <div class="flow-top">
      <span class="flow-exit" onclick="closeFlow('pr')">‚Äπ Exit</span>
      <span class="flow-pr-badge">‚ú¶ PRACTICE MODE</span>
      <div style="width:70px"></div>
    </div>
    <div class="flow-prog">
      <div class="flow-step-label" id="pr-label">Step 1 of 10</div>
      <div class="prog-bar"><div class="prog-fill pr-fill" id="pr-fill" style="width:10%"></div></div>
    </div>
    <div class="flow-content" id="pr-content"></div>
    <div class="flow-footer">
      <button class="f-back" id="pr-back" onclick="prNav(-1)">‚Äπ Back</button>
      <button class="f-next pr-next" id="pr-next" onclick="prNav(1)">Next Step ‚Ä∫</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       HOME
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen active" id="screen-home">
    <!-- Hope Resuscitated header -->
    <div class="hope-header">
      <div class="hope-logo">üíú</div>
      <div>
        <div class="hope-name">HOPE RESUSCITATED</div>
        <div class="hope-sub">RESUSCITATED</div>
      </div>
    </div>
    <div class="tagline-strip">
      <div class="tagline-main">NO STIGMA ‚Ä¢ NO BARRIERS ‚Ä¢ JUST HOPE</div>
      <div class="tagline-sub">PREVENTING TEEN OVERDOSE WITH NARCAN</div>
    </div>

    <div style="overflow-y:auto;-webkit-overflow-scrolling:touch;flex:1;">
      <!-- Hero -->
      <div class="hero-section">
        <div class="hero-title">Overdose<br>Response Guide</div>
        <div class="hero-desc">Quick access to life-saving information. Choose how you want to proceed.</div>
        <button class="start-em-btn" onclick="openFlow('em')">
          <div class="sem-icon">‚ö†Ô∏è</div>
          <div class="sem-title">Start Emergency Response</div>
        </button>
      </div>

      <!-- Learn & Prepare -->
      <div class="learn-section">
        <div class="learn-head">Learn &amp; Prepare</div>

        <div class="lcard" onclick="openFlow('pr')">
          <div class="lcard-icon">‚ñ∂Ô∏è</div>
          <div>
            <div class="lcard-title">Practice Mode</div>
            <div class="lcard-desc">Walk through the steps with shortened timers</div>
          </div>
        </div>

        <div class="lcard" onclick="showScreen('guide')">
          <div class="lcard-icon" style="background:rgba(59,130,246,0.12);border-color:rgba(59,130,246,0.3)">üìñ</div>
          <div>
            <div class="lcard-title">Quick Reference</div>
            <div class="lcard-desc">View all steps, signs, and emergency guidance</div>
          </div>
        </div>

        <div class="lcard" onclick="showScreen('guide');setTimeout(()=>document.getElementById('safety-anchor').scrollIntoView({behavior:'smooth'}),120)">
          <div class="lcard-icon" style="background:rgba(139,92,246,0.12);border-color:var(--purple-border)">üõ°Ô∏è</div>
          <div>
            <div class="lcard-title">Safety Info</div>
            <div class="lcard-desc">Naloxone safety and legal protections</div>
          </div>
        </div>
      </div>

      <!-- Disclaimer -->
      <div class="disclaimer">
        <div class="d-icon">‚ÑπÔ∏è</div>
        <div class="d-text">This app is for informational purposes only. Always call 911 immediately in a suspected overdose.</div>
      </div>

      <!-- Contact -->
      <div class="contact-section">
        <div class="contact-head">Contact Hope Resuscitated</div>
        <div class="crow">üìû 225-286-1608</div>
        <div class="crow">üåê <a href="https://www.hoperesuscitated.org">www.hoperesuscitated.org</a></div>
        <div class="crow">‚úâÔ∏è Hoperesuscitatedteam@gmail.com</div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       GUIDE
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="screen-guide">
    <div class="guide-top">
      <div class="guide-back" onclick="showScreen('home')">‚Äπ Back</div>
      <div class="breadcrumb">
        <div class="bc-item" onclick="showScreen('home')">Home</div>
        <div class="bc-item active">Quick Reference</div>
        <div class="bc-item" onclick="openFlow('pr')">Practice</div>
      </div>
    </div>
    <div class="guide-body">
      <div class="guide-section">
        <div style="margin-bottom:14px"><span class="pill-badge">üìñ Educational Reference</span></div>
        <div style="font-size:30px;font-weight:900;letter-spacing:-0.5px;margin-bottom:10px;line-height:1.1">Overdose Response Guide</div>
        <div style="font-size:14px;color:var(--text2);line-height:1.6;margin-bottom:4px">Complete reference for naloxone administration. Scroll to review all steps or use the emergency flow for live guidance.</div>
      </div>

      <div class="guide-section" style="padding-top:20px;">
        <div class="g-section-title">Signs of Opioid Overdose</div>

        <div class="sign-card"><div class="sign-ico">üñêÔ∏è</div><div><div class="sign-title">Limp body</div><div class="sign-desc">Muscles completely relaxed, no tone</div></div></div>
        <div class="sign-card"><div class="sign-ico">üò∂</div><div><div class="sign-title">Unresponsive</div><div class="sign-desc">Won't wake up to voice or touch</div></div></div>
        <div class="sign-card"><div class="sign-ico">üíô</div><div><div class="sign-title">Blue or pale lips/skin</div><div class="sign-desc">Cyanosis ‚Äî lack of oxygen</div></div></div>
        <div class="sign-card"><div class="sign-ico">üëÅÔ∏è</div><div><div class="sign-title">Pinpoint pupils</div><div class="sign-desc">Very tiny even in low light</div></div></div>
        <div class="sign-card"><div class="sign-ico">üå¨Ô∏è</div><div><div class="sign-title">Slow or no breathing</div><div class="sign-desc">Fewer than 1 breath per 5 seconds</div></div></div>
        <div class="sign-card"><div class="sign-ico">üîä</div><div><div class="sign-title">Gurgling / snoring sounds</div><div class="sign-desc">"Death rattle" ‚Äî blocked airway</div></div></div>
      </div>

      <div class="guide-section" style="padding-top:20px;">
        <div class="g-section-title">Emergency Steps</div>

        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge">1</div>
          <div><div class="step-ref-title">Check for responsiveness</div><div class="step-ref-sub">Shout name, shake shoulders, sternum rub</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge">2</div>
          <div><div class="step-ref-title">Call 911 immediately</div><div class="step-ref-sub">Tell them it's an opioid overdose</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge">3</div>
          <div><div class="step-ref-title">Select &amp; prepare Narcan</div><div class="step-ref-sub">Nasal spray or injectable</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge">4</div>
          <div><div class="step-ref-title">Administer naloxone</div><div class="step-ref-sub">Full dose in one nostril, or inject</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge">5</div>
          <div><div class="step-ref-title">Wait &amp; monitor ‚Äî 3 min timer</div><div class="step-ref-sub">Watch for improvement; 2nd dose if needed</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
        <div class="step-ref" onclick="openFlow('em')">
          <div class="step-badge" style="background:var(--green)">6</div>
          <div><div class="step-ref-title">Recovery position</div><div class="step-ref-sub">On their side ‚Äî stay until EMS arrives</div></div>
          <div class="step-ref-arrow">‚Ä∫</div>
        </div>
      </div>

      <div id="safety-anchor" class="guide-section" style="padding-top:20px;padding-bottom:16px;display:flex;flex-direction:column;gap:12px;">
        <div class="g-section-title">Safety Information</div>
        <div class="info-box purple"><strong>üõ°Ô∏è Good Samaritan Laws</strong>Most U.S. states protect you from arrest when you call 911 to help someone overdosing. Saving a life is always the right call.</div>
        <div class="info-box green"><strong>‚úÖ Naloxone Is Safe</strong>Only reverses opioid effects. Will not harm someone without opioids in their system. Safe for all ages.</div>
        <div class="info-box amber"><strong>‚ö†Ô∏è Re-sedation Risk</strong>Narcan wears off in 30‚Äì90 minutes. Stay with the person ‚Äî they may need additional doses or emergency care.</div>
        <div class="info-box red"><strong>üö® Fentanyl Warning</strong>Potent synthetic opioids may require multiple doses of Narcan. Never give up and always wait for EMS.</div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       TIMER
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="screen-timer">
    <div class="timer-top">
      <div style="font-size:26px;font-weight:900;letter-spacing:-0.5px">Dose Timer</div>
      <div style="font-size:14px;color:var(--text2);margin-top:4px">Track timing and doses given</div>
    </div>
    <div class="timer-body">
      <div class="card">
        <div class="timer-card-inner">
          <div class="big-timer" id="t-disp">2:00</div>
          <div class="timer-lbl" id="t-lbl">MINUTES UNTIL NEXT CHECK</div>
          <div class="t-btns">
            <button class="t-btn t-green" style="flex:2" onclick="startTimer()">‚ñ∂ Start</button>
            <button class="t-btn t-dark" style="flex:2" onclick="stopTimer()">‚è∏ Pause</button>
            <button class="t-btn t-dark t-icon" onclick="resetTimer()">‚Ü∫</button>
          </div>
        </div>
      </div>

      <div class="section-lbl">Dose Tracker</div>
      <div class="card">
        <div class="dose-slots">
          <div class="ds" id="ds1"><span class="ds-n">1</span><div class="ds-l">1st Dose</div><div class="ds-t" id="dt1">‚Äî</div></div>
          <div class="ds" id="ds2"><span class="ds-n">2</span><div class="ds-l">2nd Dose</div><div class="ds-t" id="dt2">‚Äî</div></div>
          <div class="ds" id="ds3"><span class="ds-n">3</span><div class="ds-l">3rd Dose</div><div class="ds-t" id="dt3">‚Äî</div></div>
        </div>
        <div style="padding:12px 16px 16px">
          <button class="btn btn-full btn-red" id="dose-btn" onclick="recordDose()">üíâ Record Dose Given</button>
          <div id="dose-note" style="text-align:center;font-size:12px;color:var(--green);margin-top:10px;display:none;font-weight:600">‚úì Timer auto-started for next dose check</div>
        </div>
      </div>

      <div class="section-lbl">Rescue Breath Pacer</div>
      <div class="card">
        <div class="breath-wrap">
          <div class="breath-ring" id="b-ring" onclick="toggleBreath()">ü´Å</div>
          <div class="b-lbl" id="b-lbl">Tap to start</div>
          <div class="b-sub">Pulses every 5 seconds ‚Äî give 1 breath per pulse</div>
        </div>
      </div>

      <div class="warn-strip">
        <span style="font-size:18px;flex-shrink:0">‚ö†Ô∏è</span>
        <span>Narcan wears off in 30‚Äì90 min. Stay with the person until EMS arrives.</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       HELP
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="screen-help">
    <div class="help-top">
      <div style="font-size:26px;font-weight:900;letter-spacing:-0.5px">Help &amp; Resources</div>
      <div style="font-size:14px;color:var(--text2);margin-top:4px">Emergency contacts and where to get Narcan</div>
    </div>
    <div class="help-body">
      <div class="section-lbl">Emergency</div>
      <div class="card">
        <div class="res-item" onclick="if(confirm('Call 911?'))location.href='tel:911'">
          <div class="res-ico" style="background:rgba(239,68,68,0.12)">üö®</div>
          <div><div class="res-title">911 ‚Äî Emergency Services</div><div class="res-sub">Call immediately for overdose</div></div>
          <div class="res-arrow">üìû</div>
        </div>
        <div class="res-item">
          <div class="res-ico" style="background:rgba(59,130,246,0.12)">‚òéÔ∏è</div>
          <div><div class="res-title">Poison Control</div><div class="res-sub">1-800-222-1222 ‚Ä¢ Available 24/7</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
        <div class="res-item">
          <div class="res-ico" style="background:rgba(16,185,129,0.12)">üí¨</div>
          <div><div class="res-title">SAMHSA Helpline</div><div class="res-sub">1-800-662-4357 ‚Ä¢ Free &amp; confidential</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
        <div class="res-item">
          <div class="res-ico" style="background:rgba(139,92,246,0.12)">üì±</div>
          <div><div class="res-title">Crisis Text Line</div><div class="res-sub">Text HOME to 741741</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
      </div>

      <div class="section-lbl">Getting Narcan</div>
      <div class="card">
        <div class="res-item">
          <div class="res-ico" style="background:rgba(59,130,246,0.12)">üè™</div>
          <div><div class="res-title">Pharmacies ‚Äî No Rx Needed</div><div class="res-sub">CVS, Walgreens, Walmart, Rite Aid</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
        <div class="res-item">
          <div class="res-ico" style="background:rgba(16,185,129,0.12)">üÜì</div>
          <div><div class="res-title">Free Narcan Programs</div><div class="res-sub">NEXT Distro ‚Ä¢ local health departments</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
        <div class="res-item">
          <div class="res-ico" style="background:rgba(245,158,11,0.12)">üè•</div>
          <div><div class="res-title">Find Narcan Near You</div><div class="res-sub">nasal-naloxone.org ‚Ä¢ harmreduction.org</div></div>
          <div class="res-arrow">‚Ä∫</div>
        </div>
      </div>

      <div class="info-box purple"><strong>üõ°Ô∏è Good Samaritan Laws</strong>Most U.S. states protect you from prosecution when you call 911 to help someone overdosing.</div>
      <div class="info-box amber"><strong>‚ö†Ô∏è Narcan Wears Off</strong>Naloxone lasts 30‚Äì90 minutes. Always stay with the person until EMS arrives ‚Äî they may need more doses.</div>
      <div class="info-box green"><strong>üìö Learn More</strong>SAMHSA.gov ‚Ä¢ HarmReduction.org ‚Ä¢ NextDistro.org ‚Ä¢ cdc.gov/opioids</div>

      <div class="section-lbl">Contact Hope Resuscitated</div>
      <div class="card" style="padding:18px">
        <div class="crow">üìû <span style="color:var(--text2)">225-286-1608</span></div>
        <div class="crow" style="margin-top:8px">üåê <span style="color:var(--purple)">www.hoperesuscitated.org</span></div>
        <div class="crow" style="margin-top:8px">‚úâÔ∏è <span style="color:var(--text2)">Hoperesuscitatedteam@gmail.com</span></div>
      </div>
    </div>
  </div>

  <!-- BOTTOM NAV -->
  <div id="bottom-nav">
    <button class="nb active" id="nav-home" onclick="showScreen('home')">
      <span class="nb-icon">üè†</span>
      <span class="nb-lbl">HOME</span>
    </button>
    <button class="nb" id="nav-guide" onclick="showScreen('guide')">
      <span class="nb-icon">üìñ</span>
      <span class="nb-lbl">GUIDE</span>
    </button>
    <button class="nb" id="nav-timer" onclick="showScreen('timer')">
      <span class="nb-icon">‚è±Ô∏è</span>
      <span class="nb-lbl">TIMER</span>
    </button>
    <button class="nb" id="nav-help" onclick="showScreen('help')">
      <span class="nb-icon">üìû</span>
      <span class="nb-lbl">HELP</span>
    </button>
  </div>
</div>

<script>
// ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ
(function tick(){
  const n=new Date(),h=n.getHours(),m=n.getMinutes().toString().padStart(2,'0');
  document.getElementById('clock').textContent=(h%12||12)+':'+m;
})();
setInterval(()=>{const n=new Date(),h=n.getHours(),m=n.getMinutes().toString().padStart(2,'0');document.getElementById('clock').textContent=(h%12||12)+':'+m;},30000);

// ‚îÄ‚îÄ NAV ‚îÄ‚îÄ
function showScreen(s){
  document.querySelectorAll('.screen').forEach(x=>x.classList.remove('active'));
  document.querySelectorAll('.nb').forEach(b=>{b.classList.remove('active');b.classList.remove('red-active');});
  document.getElementById('screen-'+s).classList.add('active');
  const nb=document.getElementById('nav-'+s);
  if(nb){nb.classList.add(s==='help'?'red-active':'active');}
  document.getElementById('screen-'+s).scrollTop=0;
}

// ‚îÄ‚îÄ FLOW ENGINE ‚îÄ‚îÄ
let narcanType='nasal';
let emIdx=0, prIdx=0;
let emTmr=null,emSecs=0,prTmr=null,prSecs=0;

function buildSteps(practice){
  const steps=[
    {
      title:'Check for responsiveness',
      desc:'Shout their name and shake their shoulders firmly. If no response, rub your knuckles on their breastbone (sternum rub). Look for any signs of movement or awareness.',
      icon:'üßç',caption:'Check for responsiveness ‚Äî tap shoulders and shout name',
      timer:null,checklist:null,
    },
    {
      title:'Call 911 immediately',
      desc:'Call emergency services right away. Tell them you think someone is having an opioid overdose. Give your location clearly. Put the phone on speaker if possible so you can continue helping.',
      icon:'üìû',caption:'Call 911 ‚Äî stay on the line with the operator',
      timer:null,checklist:null,
    },
    {
      title:'What type of Narcan do you have?',
      desc:'Select the form you have available',
      isNarcanPick:true,timer:null,icon:null,
    },
  ];

  if(narcanType==='nasal'){
    steps.push(
      {title:'Prepare nasal spray',desc:'Remove the NARCAN nasal spray from packaging. Hold the device with your thumb on the bottom and first two fingers on either side of the nozzle. Do NOT prime or test the spray ‚Äî each device has only one dose.',icon:'üíß',caption:'Prepare nasal spray ‚Äî remove from packaging carefully',timer:null,checklist:null},
      {title:'Administer nasal spray',desc:'Insert the nozzle into one nostril until your fingers touch the bottom of the nose. Press the plunger firmly to release the full dose. The spray should go into ONE nostril only.',icon:'üí®',caption:'Insert into one nostril ‚Äî press plunger firmly all the way',timer:null,checklist:null}
    );
  } else {
    steps.push(
      {title:'Prepare injectable naloxone',desc:'Open the kit and assemble the syringe. Draw up 1 mL of naloxone from the vial. Tap out any air bubbles. Ready for injection into a large muscle.',icon:'üíâ',caption:'Prepare the naloxone injection kit',timer:null,checklist:null},
      {title:'Administer injection',desc:'Insert needle at 90¬∞ angle into the outer thigh (through clothing if needed) or upper arm. Push the plunger firmly all the way. Withdraw needle and apply pressure.',icon:'üíâ',caption:'Inject into outer thigh or upper arm muscle',timer:null,checklist:null}
    );
  }

  const timerSecs = practice ? 10 : 180;
  const timerSub = practice ? 'Practice Mode ‚Äî 10 seconds' : 'Emergency Mode ‚Äî Full 3 minutes';

  steps.push(
    {title:'Wait and monitor',desc:'Wait 2-3 minutes for the Narcan to take effect. Watch for signs of improvement: increased breathing, movement, or responsiveness. If no response after 2-3 minutes, give a second dose if available.',icon:'‚è±Ô∏è',caption:'Watch for chest rise and signs of improvement',timer:{secs:timerSecs,sub:timerSub},checklist:[{icon:'üí®',text:'Check breathing ‚Äî look for chest rise'},{icon:'üßë‚Äçü§ù‚Äçüßë',text:'Place in recovery position if breathing'}]},
    {title:'Give second dose if needed',desc:"If there's no improvement after 2-3 minutes, give another dose of Narcan. Use the other nostril for nasal spray, or prepare a new injection. Continue monitoring and provide rescue breathing if trained.",icon:'üîÑ',caption:'Give second dose ‚Äî use the other nostril',timer:null,checklist:null},
    {title:'Recovery position',desc:'Once the person is breathing on their own, place them in the recovery position: on their side with the top leg bent, head supported, and airway open. Stay with them until help arrives.',icon:'üåø',caption:'Recovery position ‚Äî on their side, airway open',timer:null,checklist:null,isDone:true}
  );

  return steps;
}

function fmtSecs(s){ return Math.floor(s/60)+':'+(s%60).toString().padStart(2,'0'); }

function renderFlow(mode){
  const em = mode==='em';
  const steps = buildSteps(!em);
  const idx = em ? emIdx : prIdx;
  const total = steps.length;
  const step = steps[idx];
  const pct = ((idx+1)/total*100).toFixed(1);

  document.getElementById(em?'em-label':'pr-label').textContent=`Step ${idx+1} of ${total}`;
  document.getElementById(em?'em-fill':'pr-fill').style.width=pct+'%';

  const backBtn=document.getElementById(em?'em-back':'pr-back');
  const nextBtn=document.getElementById(em?'em-next':'pr-next');
  backBtn.disabled = idx===0;

  if(step.isDone){
    nextBtn.textContent='‚Ü∫ Done';
    nextBtn.onclick=()=>closeFlow(mode);
  } else {
    nextBtn.innerHTML='Next Step ‚Ä∫';
    nextBtn.onclick=em?()=>emNav(1):()=>prNav(1);
  }

  let html='';

  if(step.isNarcanPick){
    html+=`<div class="flow-title" style="font-size:24px">${step.title}</div>`;
    html+=`<div class="flow-desc">${step.desc}</div>`;
    html+=`
      <div class="nc-pick ${narcanType==='nasal'?'sel':''}" onclick="pickNarcan('nasal','${mode}')">
        <div class="nc-ico">üíß</div>
        <div><div class="nc-title">Nasal Spray</div><div class="nc-sub">NARCAN¬Æ Nasal Spray or similar</div></div>
      </div>
      <div class="nc-pick ${narcanType==='injectable'?'sel':''}" onclick="pickNarcan('injectable','${mode}')">
        <div class="nc-ico">üíâ</div>
        <div><div class="nc-title">Injectable</div><div class="nc-sub">Naloxone injection kit</div></div>
      </div>`;
  } else {
    html+=`<div class="flow-title">${step.title}</div>`;
    html+=`<div class="flow-desc">${step.desc}</div>`;
    if(step.icon){
      html+=`<div class="photo-placeholder"><div class="ph-big">${step.icon}</div><div class="ph-caption">${step.caption||''}</div></div>`;
    }
    if(step.timer){
      const tsecs = step.timer.secs;
      if(em){ emSecs=tsecs; clearInterval(emTmr);emTmr=null; }
      else { prSecs=tsecs; clearInterval(prTmr);prTmr=null; }
      const pid = em?'em-tnum':'pr-tnum';
      const pbid = em?'em-tplay':'pr-tplay';
      html+=`
        <div class="obs-box">
          <div class="obs-head">Observation Timer</div>
          <div class="obs-num" id="${pid}">${fmtSecs(tsecs)}</div>
          <div class="obs-sub">${step.timer.sub}</div>
          <div class="obs-btns">
            <button class="obs-btn" onclick="${em?'emReset':'prReset'}()" title="Reset">‚Ü∫</button>
            <button class="obs-btn" id="${pbid}" onclick="${em?'emToggle':'prToggle'}()" title="Play/Pause">‚ñ∂</button>
          </div>
        </div>`;
      setTimeout(()=>{ em?startEmTmr():startPrTmr(); },400);
    }
    if(step.checklist){
      html+=`<div class="check-list">`;
      step.checklist.forEach(c=>{ html+=`<div class="check-item"><span class="ci-ico">${c.icon}</span>${c.text}</div>`; });
      html+=`</div>`;
    }
  }

  document.getElementById(em?'em-content':'pr-content').innerHTML=html;
}

function pickNarcan(t,mode){
  narcanType=t;
  renderFlow(mode);
}

// em timer
function startEmTmr(){
  if(emTmr)return;
  const pb=document.getElementById('em-tplay');if(pb)pb.textContent='‚è∏';
  emTmr=setInterval(()=>{
    if(emSecs<=0){
      clearInterval(emTmr);emTmr=null;
      const el=document.getElementById('em-tnum');
      if(el){el.textContent='‚úì CHECK NOW';el.style.fontSize='34px';el.style.color='var(--green)';}
      if(navigator.vibrate)navigator.vibrate([500,200,500,200,500]);
      return;
    }
    emSecs--;
    const el=document.getElementById('em-tnum');
    if(el){el.textContent=fmtSecs(emSecs);el.className='obs-num'+(emSecs<=20?' urgent':'');}
  },1000);
}
function emToggle(){
  if(emTmr){clearInterval(emTmr);emTmr=null;const p=document.getElementById('em-tplay');if(p)p.textContent='‚ñ∂';}
  else startEmTmr();
}
function emReset(){
  clearInterval(emTmr);emTmr=null;
  const steps=buildSteps(false);if(steps[emIdx]&&steps[emIdx].timer)emSecs=steps[emIdx].timer.secs;
  const el=document.getElementById('em-tnum');
  if(el){el.textContent=fmtSecs(emSecs);el.className='obs-num';el.style.fontSize='';el.style.color='';}
  const p=document.getElementById('em-tplay');if(p)p.textContent='‚ñ∂';
}

// pr timer
function startPrTmr(){
  if(prTmr)return;
  const pb=document.getElementById('pr-tplay');if(pb)pb.textContent='‚è∏';
  prTmr=setInterval(()=>{
    if(prSecs<=0){
      clearInterval(prTmr);prTmr=null;
      const el=document.getElementById('pr-tnum');
      if(el){el.textContent='‚úì DONE';el.style.fontSize='34px';el.style.color='var(--green)';}
      return;
    }
    prSecs--;
    const el=document.getElementById('pr-tnum');
    if(el){el.textContent=fmtSecs(prSecs);el.className='obs-num'+(prSecs<=5?' urgent':'');}
  },1000);
}
function prToggle(){
  if(prTmr){clearInterval(prTmr);prTmr=null;const p=document.getElementById('pr-tplay');if(p)p.textContent='‚ñ∂';}
  else startPrTmr();
}
function prReset(){
  clearInterval(prTmr);prTmr=null;
  const steps=buildSteps(true);if(steps[prIdx]&&steps[prIdx].timer)prSecs=steps[prIdx].timer.secs;
  const el=document.getElementById('pr-tnum');
  if(el){el.textContent=fmtSecs(prSecs);el.className='obs-num';el.style.fontSize='';el.style.color='';}
  const p=document.getElementById('pr-tplay');if(p)p.textContent='‚ñ∂';
}

function openFlow(mode){
  clearInterval(emTmr);emTmr=null;clearInterval(prTmr);prTmr=null;
  if(mode==='em'){emIdx=0;document.getElementById('em-overlay').classList.add('on');}
  else{prIdx=0;document.getElementById('pr-overlay').classList.add('on');}
  renderFlow(mode);
}
function closeFlow(mode){
  clearInterval(emTmr);emTmr=null;clearInterval(prTmr);prTmr=null;
  document.getElementById(mode==='em'?'em-overlay':'pr-overlay').classList.remove('on');
}
function emNav(d){
  clearInterval(emTmr);emTmr=null;
  const steps=buildSteps(false);
  const n=emIdx+d;if(n<0||n>=steps.length)return;
  emIdx=n;renderFlow('em');document.getElementById('em-content').scrollTop=0;
}
function prNav(d){
  clearInterval(prTmr);prTmr=null;
  const steps=buildSteps(true);
  const n=prIdx+d;if(n<0||n>=steps.length)return;
  prIdx=n;renderFlow('pr');document.getElementById('pr-content').scrollTop=0;
}

// ‚îÄ‚îÄ MAIN TIMER SCREEN ‚îÄ‚îÄ
let tmrInt=null,tmrSecs=120;
function updTimer(){
  const m=Math.floor(tmrSecs/60),s=(tmrSecs%60).toString().padStart(2,'0');
  const el=document.getElementById('t-disp');
  if(tmrSecs<=0){el.textContent='CHECK!';el.className='big-timer urgent';document.getElementById('t-lbl').textContent='TIME ‚Äî CHECK FOR RESPONSE';}
  else{el.textContent=m+':'+s;el.className='big-timer'+(tmrSecs<=15?' urgent':'');document.getElementById('t-lbl').textContent='MINUTES UNTIL NEXT CHECK';}
}
function startTimer(){if(tmrInt)return;tmrInt=setInterval(()=>{if(tmrSecs<=0){clearInterval(tmrInt);tmrInt=null;if(navigator.vibrate)navigator.vibrate([500,200,500]);updTimer();return;}tmrSecs--;updTimer();},1000);}
function stopTimer(){clearInterval(tmrInt);tmrInt=null;}
function resetTimer(){stopTimer();tmrSecs=120;document.getElementById('t-disp').className='big-timer';updTimer();}

let dCount=0;
function recordDose(){
  if(dCount>=3)return;dCount++;
  document.getElementById('ds'+dCount).classList.add('given');
  document.getElementById('dt'+dCount).textContent=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
  resetTimer();startTimer();
  document.getElementById('dose-note').style.display='block';
  if(dCount>=3){const b=document.getElementById('dose-btn');b.disabled=true;b.textContent='3 doses given ‚Äî await EMS';b.style.background='var(--text3)';}
}

let breathOn=false;
function toggleBreath(){
  breathOn=!breathOn;
  document.getElementById('b-ring').classList.toggle('active',breathOn);
  document.getElementById('b-lbl').textContent=breathOn?'Give 1 breath per pulse':'Tap to start';
}
</script>
</body>
</html>
